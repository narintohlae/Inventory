<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แสดงข้อมูลจาก Google Sheet</title>
    <style>
        body { font-family: sans-serif; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #dddddd; text-align: left; padding: 8px; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>

    <h1>ตารางข้อมูลจาก Google Sheet</h1>
    <div id="loading">กำลังโหลดข้อมูล...</div>
    <table id="data-table" style="display:none;">
        <thead>
            <tr id="table-header"></tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>

    <script>
        // --- วาง URL ที่คัดลอกมา ตรงนี้ ---
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbyP0NlmEZflV4EpPkMTzJcEcsni9tQcwz3HIS4ZaCldMTafTN0Xts2xG-0PB_cFN5_Sbg/exec'; 

        // ดึงข้อมูลจาก API ที่เราสร้าง
        fetch(WEB_APP_URL)
            .then(response => response.json())
            .then(res => {
                if (res.status === 'success') {
                    const data = res.data;
                    const table = document.getElementById('data-table');
                    const headerRow = document.getElementById('table-header');
                    const tableBody = document.getElementById('table-body');
                    const loadingDiv = document.getElementById('loading');
                    
                    if (data.length > 0) {
                        // สร้าง Header ของตาราง
                        const headers = Object.keys(data[0]);
                        headers.forEach(headerText => {
                            const th = document.createElement('th');
                            th.textContent = headerText;
                            headerRow.appendChild(th);
                        });

                        // สร้างแถวข้อมูล
                        data.forEach(rowData => {
                            const row = document.createElement('tr');
                            headers.forEach(header => {
                                const cell = document.createElement('td');
                                cell.textContent = rowData[header];
                                row.appendChild(cell);
                            });
                            tableBody.appendChild(row);
                        });
                        
                        loadingDiv.style.display = 'none';
                        table.style.display = 'table';
                    } else {
                         loadingDiv.textContent = 'ไม่พบข้อมูล';
                    }
                } else {
                    console.error('Error from API:', res.message);
                    document.getElementById('loading').textContent = 'เกิดข้อผิดพลาด: ' + res.message;
                }
            })
            .catch(error => {
                console.error('Fetch Error:', error);
                document.getElementById('loading').textContent = 'ไม่สามารถเชื่อมต่อกับ API ได้';
            });
    </script>

</body>
</html>

